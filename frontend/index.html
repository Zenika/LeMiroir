<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>MARCEL v2</title>
    <script src="bower_components/webcomponentsjs/webcomponents-lite.js"></script>
    <link rel="import" href="bower_components/polymer/polymer.html">
  </head>
  <body onload="loadComponents()">
    <section id="components"></section>
    <script src="bower_components/polymer_dynamic_components/polymer_asyncComponentLoader.js"></script>
    <script>
      function launchLoad (serverIp) {
        polymerAsyncLoader = new Polymer_AsyncComponentLoader('components', 'http://' + serverIp + ':8090/api/v1/media/1', 'http://' + serverIp + '/plugins');
        polymerAsyncLoader.load();
      }

      function loadComponents () {
        fetch('http://localhost/config.json')
          .then(res => res.json())
          .then(res => {
            serverIp = res.ip || 'localhost';
            launchLoad(serverIp);
          })
          .catch(() => {
            launchLoad('localhost');
          })
      }
    </script>
  </body>
</html>
